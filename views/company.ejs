<!DOCTYPE html>
<html>

<head>
  <title>会社</title>
  <%- include("./common/stylesheets.ejs") %>
</head>

<body>
  <%- include("./common/header.ejs") %>
  <section class="main">
    <div class="msg">
      <div class="msgarea">
        <p class="msgarea__text">解約します。<br>よろしいですか？</p>
        <button class="msgarea__okbtn">はい</button>
        <button class="msgarea__ngbtn">いいえ</button>
      </div>
    </div>
  <div class="main__wrapper">
      <div class="area-link">
        <a class="btn-link" href="/">TOPへ</a>
        <a class="btn-link" href="/person/add/<%= company.id %>">個人登録</a>
      </div>
      <h1 class="title"><%= company.name %></h1>
      <div class="company">
        <form name="cancelForm" method="POST" action="/company/cancel">
          <!-- /.company__btn-cancel -->
          <dl>
            <dt>会社番号</dt>
            <dd><input type="text" class="form__item-readonly-style" name="id" value="<%= company.id %>" disabled></dd>
            <dt>入居番号</dt>
            <dd><input type="text" class="form__item-readonly-style" name="id_nyukyo" value="<%= company.id_nyukyo %>" disabled>
            </dd>
            <dt>会議室利用番号</dt>
            <dd><input type="text" class="form__item-readonly-style" name="id_kaigi" value="<%= company.id_kaigi %>" disabled>
            </dd>
            <dt>会社区分</dt>
            <dd><input type="text" class="form__item-readonly-style" name="kubun_company" value="<%= company.kubun_company %>" disabled>
            </dd>
            <dt>入居年月日</dt>
            <dd><input type="text" class="form__item-readonly-style" name="ymd_nyukyo" value="<%= company.ymd_nyukyo %>" disabled>
            </dd>
            <dt>解約年月日</dt>
            <dd><input type="text" class="form__item-readonly-style" name="ymd_kaiyaku" value="<%= company.ymd_kaiyaku %>" disabled>
            </dd>
            <dt>会社名</dt>
            <dd><input type="text" class="form__item-readonly-style" name="name" value="<%= company.name %>" disabled></dd>
            <dt>会社名カナ</dt>
            <dd><input type="text" class="form__item-readonly-style" name="kana" value="<%= company.kana %>" disabled></dd>
            <dt>備考</dt>
            <dd><input type="text" class="form__item-readonly-style" name="bikou" value="<%= company.bikou %>" disabled></dd>
            <div class="form__btn">
              <input type="button" class="btn-base" id="cancelbtn" value="解約">
              <a class="btn-base" href="/company/update/<%= company.id %>">更新</a>
              <a class="btn-base" href="/company/delete/<%= company.id %>">削除</a>
            </div>
            <input type="hidden" name="id_company" value="<%= company.id %>">
            <input type="hidden" name="id_nyukyo" value="<%= company.id_nyukyo %>">
          </dl>
        </form>
      </div>
      <!-- /.company -->
      <div class="person">
        <div class="person__header">
          <p class="midashi">個人</p>
        </div>
        <div class="person__items">
          <% if (persons) { %>
          <%  persons.forEach( person => { %>
          <div class="person__item">
            <a class="btn-link" href="/person/<%= person.id %>"><%= person.name %>（<%= person.id %>）</a>
          </div>
          <%  }); %>
          <% } %>
        </div>
        <!-- /.person__items -->
      </div>
      <!-- /.person -->

      <div class="room">
        <div class="room__header">
          <p class="midashi">部屋</p>
        </div>
        <form name="roomForm" class="room__form" method="POST" action="/company/addroom">
          <select name="id_room" class="form__item-style room__select">
            <option value="" selected>--部屋選択--</option>
            <% selectrooms.forEach( selectroom => { %>
            <option value="<%= selectroom.id %>">
              <%= selectroom.kubun %><%= selectroom.name %>（<%= selectroom.id %>）<%= selectroom.place %> /
              <%= selectroom.floor %>
            </option>
            <% }) %>
          </select>
          <input class="btn-base ml-small" type="submit" value="追加">
          <input type="hidden" name="id_company" value="<%= company.id %>">
        </form>
        <div class="room__items">
          <% if (rooms) { %>
          <%  rooms.forEach( room => { %>
          <div class="room__item">
            <%= room.name %>（<%= room.id %>）%><%= room.place %>
            <% if (room.place) { %>
              ：
            <% } %><%= room.floor %> 
            <a class="tag" href="/company/deleteroom/<%= company.id %>/<%= room.id %>/<%= room.no_seq %>">削除</a>
          </div>
          <% }) %>
          <% } %>
        </div>
      </div>
      <!-- /.room -->

      <div class="nyukyo">
        <div class="nyukyo__header">
          <% if (nyukyo) { %>
            <p class="midashi">入居番号　<%= nyukyo.id %></p>
          <% } else { %>
            <p class="midashi">入居番号</p>
          <% } %>
        </div>
        <% if (nyukyo) { %>
        <div class="nyukyo__items">
          <% nyukyocompanies.forEach( nyukyocompany  => { %>
          <div class="nyukyo__item">
            <a class="btn-link" href="/company/<%= nyukyocompany.id %>">
              <%= nyukyocompany.name %>（<%= nyukyocompany.id %>）
            </a>
          </div>
          <% }) %>
        </div>
        <% } %>
      </div>
      <!-- /.nyukyo -->

      <div class="cabinet">
        <div class="cabinet__header">
          <p class="midashi">キャビネット</p>
        </div>
        <% if (nyukyo) { %>
        <form name="cabinetForm" class="cabinet__form" method="POST" action="/company/addcabinet" onsubmit="return checkCancel();">
          <select name="id_cabinet" class="form__item-style cabinet__select">
            <option value="" selected>--キャビネット選択--</option>
            <% freecabinets.forEach(function (freecabinet) { %>
            <option value="<%= freecabinet.id %>">
              <%= freecabinet.name %>（<%= freecabinet.id %>）<%= freecabinet.place %>
            </option>
            <% }) %>
          </select>
          <input class="btn-base ml-small" type="submit" value="追加">
          <input type="hidden" name="id_nyukyo" value="<%= company.id_nyukyo %>">
          <input type="hidden" name="id_company" value="<%= company.id %>">
        </form>
        <div class="cabinet__items">
          <% if (cabinets) { %>
          <%  cabinets.forEach( cabinet => { %>
          <div class="cabinet__item">
            <%= cabinet.name %>（<%= cabinet.id %>）<%= cabinet.place %>
            <a class="tag" href="/company/deletecabinet/<%= company.id %>/<%= nyukyo.id %>/<%= cabinet.id %>/<%= cabinet.no_seq %>">削除</a>
          </div>
          <%  }) %>
          <% } %>
        </div>
        <% } %>
      </div>
      <!-- /.cabinet -->

    </div>
    <!-- /.main-wrapper -->
  </section>
  <!-- /.main -->
</body>
<script>

    let cancelbtn = document.getElementById("cancelbtn");
    cancelbtn.addEventListener('click', function () {
      let msg = document.getElementsByClassName("msg")[0];
      msg.style.visibility = "visible";
    });
    let okbtn = document.getElementsByClassName("msgarea__okbtn")[0];
    let ngbtn = document.getElementsByClassName("msgarea__ngbtn")[0];
    okbtn.addEventListener('click', function () {
      document.cancelForm.submit();
    });
    ngbtn.addEventListener('click', function () {
      let msg = document.getElementsByClassName("msg")[0];
      msg.style.visibility = "hidden";
    });

</script>
<%- include("./common/javascripts.ejs") %>

</html>